<br />
<div>
  <h1 class="text-center purple-text"><%= current_course.title %></h1>
  <hr>
</div>

<div class="course-info purple-text text-center">
  <div class="row">
    <div class="col-sm-4">
      <%= link_to "Prevew as Student", course_path(current_course), class: 'btn btn-success' %>
    </div>
    <div class="col-sm-4">
      <%= image_tag current_course.image, class: 'img-fluid' %>
    </div>
    <div class="col-sm-4">
      <%= link_to 'Add Section', new_instructor_course_section_path(current_course), class:"btn btn-primary" %>
    </div>
</div>
</div>

    <div class="course-container">
      <div class="section">
        <ul class="sortable-list-section">
          <% current_course.sections.rank(:row_order).each do |section| %>
            <li class="section-title" data-update-url="<%=instructor_section_path(section)%>">
                <div class="lessons">
                    <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
                  <h3 class="text-center"><%= section.title %></h3>
                  <%= link_to " +New Lesson", new_instructor_section_lesson_path(section) %>
                    <ul class="sortable-list-lesson">
                      <% section.lessons.rank(:row_order).each do |lesson| %>
                          <li data-update-url="<%=instructor_lesson_path(lesson)%>">
                              <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
                            <span class="bold"><%= lesson.title %></span>
                            -
                            <span> <%= lesson.subtitle %></span>
                          </li>
                      <% end %>
                    </ul>
                </div>
            </li>
          <% end %>
        </ul>
      </div>
    </div>




<script>

$('.sortable-list-section').sortable({
  update: function( event, ui) {
    $.ajax({
      type: 'PUT',
      url: ui.item.data('update-url'),
      dataType: 'json',
      data: { section: {row_order_position: ui.item.index()}}
    });
  }
});

 $('.sortable-list-lesson').sortable({
   update: function( event, ui) {
     $.ajax({
       type: 'PUT',
       url: ui.item.data('update-url'),
       dataType: 'json',
       data: { lesson: {row_order_position: ui.item.index()}}
     });
   }
 });



</script>
